<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>アズレンwiki用 潜水艦支援範囲</title>
<style>
.tables {display: flex;}.toggleSync {display: block;padding: 16px 0 16px 10px;}.toggleSync label {border: 1px solid #999;padding: 6px 6px 6px 40px;margin-left: -30px;}table {display: inline-block;margin-right: 20px;border-spacing: 0;}table, td, th {border: 1px solid #999;}th {background: #eee;}td {width: 32px;height: 32px;background: #ccc;}td:hover {border-color: #111;background: #eee;cursor: pointer;}td input{display: none;}td.checked {background: #E1696C !important;}td.center {background: yellow !important;cursor: auto;}#template {display: none;}
</style>
</head>
<body>
<div id="main"></div>

<div>
<textarea id="template" disabled>
| &br; &br; &br; &br; &br; |0-0-0|0-0-1|0-0-2|0-0-3|0-0-4|0-0-5|0-0-6| | |1-0-0|1-0-1|1-0-2|1-0-3|1-0-4|1-0-5|1-0-6| | |2-0-0|2-0-1|2-0-2|2-0-3|2-0-4|2-0-5|2-0-6| | |3-0-0|3-0-1|3-0-2|3-0-3|3-0-4|3-0-5|3-0-6| | |4-0-0|4-0-1|4-0-2|4-0-3|4-0-4|4-0-5|4-0-6| |
|~|0-1-0|0-1-1|0-1-2|0-1-3|0-1-4|0-1-5|0-1-6|~|~|1-1-0|1-1-1|1-1-2|1-1-3|1-1-4|1-1-5|1-1-6|~|~|2-1-0|2-1-1|2-1-2|2-1-3|2-1-4|2-1-5|2-1-6|~|~|3-1-0|3-1-1|3-1-2|3-1-3|3-1-4|3-1-5|3-1-6|~|~|4-1-0|4-1-1|4-1-2|4-1-3|4-1-4|4-1-5|4-1-6|~|
|~|0-2-0|0-2-1|0-2-2|0-2-3|0-2-4|0-2-5|0-2-6|~|~|1-2-0|1-2-1|1-2-2|1-2-3|1-2-4|1-2-5|1-2-6|~|~|2-2-0|2-2-1|2-2-2|2-2-3|2-2-4|2-2-5|2-2-6|~|~|3-2-0|3-2-1|3-2-2|3-2-3|3-2-4|3-2-5|3-2-6|~|~|4-2-0|4-2-1|4-2-2|4-2-3|4-2-4|4-2-5|4-2-6|~|
|~|0-3-0|0-3-1|0-3-2|BGCOLOR(yellow): |0-3-4|0-3-5|0-3-6|~|~|1-3-0|1-3-1|1-3-2|BGCOLOR(yellow): |1-3-4|1-3-5|1-3-6|~|~|2-3-0|2-3-1|2-3-2|BGCOLOR(yellow): |2-3-4|2-3-5|2-3-6|~|~|3-3-0|3-3-1|3-3-2|BGCOLOR(yellow): |3-3-4|3-3-5|3-3-6|~|~|4-3-0|4-3-1|4-3-2|BGCOLOR(yellow): |4-3-4|4-3-5|4-3-6|~|
|~|0-4-0|0-4-1|0-4-2|0-4-3|0-4-4|0-4-5|0-4-6|~|~|1-4-0|1-4-1|1-4-2|1-4-3|1-4-4|1-4-5|1-4-6|~|~|2-4-0|2-4-1|2-4-2|2-4-3|2-4-4|2-4-5|2-4-6|~|~|3-4-0|3-4-1|3-4-2|3-4-3|3-4-4|3-4-5|3-4-6|~|~|4-4-0|4-4-1|4-4-2|4-4-3|4-4-4|4-4-5|4-4-6|~|
|~|0-5-0|0-5-1|0-5-2|0-5-3|0-5-4|0-5-5|0-5-6|~|~|1-5-0|1-5-1|1-5-2|1-5-3|1-5-4|1-5-5|1-5-6|~|~|2-5-0|2-5-1|2-5-2|2-5-3|2-5-4|2-5-5|2-5-6|~|~|3-5-0|3-5-1|3-5-2|3-5-3|3-5-4|3-5-5|3-5-6|~|~|4-5-0|4-5-1|4-5-2|4-5-3|4-5-4|4-5-5|4-5-6|~|
|~|0-6-0|0-6-1|0-6-2|0-6-3|0-6-4|0-6-5|0-6-6|~|~|1-6-0|1-6-1|1-6-2|1-6-3|1-6-4|1-6-5|1-6-6|~|~|2-6-0|2-6-1|2-6-2|2-6-3|2-6-4|2-6-5|2-6-6|~|~|3-6-0|3-6-1|3-6-2|3-6-3|3-6-4|3-6-5|3-6-6|~|~|4-6-0|4-6-1|4-6-2|4-6-3|4-6-4|4-6-5|4-6-6|~|
</textarea>
<textarea id="output" rows="10" cols="120">ここにwikiru用コードが表示されます</textarea><br>
<input type="button" id="copy" value="すべてコピー"><span id="message"></span>
</div>

<div>
■ アズレンwikiの潜水艦ページの編集のためだけのツール。他になんの役にもたちません。<br>
■ 「上位レベルに同期」をオンにしておけば、上のレベルの同じマスも自動で塗られます。Lv1から塗り始めてください。
</div>

  <script>
// 7x7のテーブルを作成
const tables = document.createElement('div');
tables.classList.add('tables');

let isSyncEnabled = true; // 同期フラグ

function toggleCellClass(checkbox, isChecked) {
  const cell = checkbox.parentElement;
  if (isChecked) {
    cell.classList.add('checked');
  } else {
    cell.classList.remove('checked');
  }
}

function updateOutput() {
  // templateのコピーを作成
  let output = document.getElementById('template').value;

  // すべてのチェックボックスを確認
  checkboxes.forEach(checkbox => {
    if (checkbox.checked) {
      // チェックありなら○に置換
      output = output.replace(checkbox.id, 'BGCOLOR(#E1696C): ');
      toggleCellClass(checkbox, true); // セルの色を変更
    } else {
      // チェックなしならXに置換
      output = output.replace(checkbox.id, ' ');
      toggleCellClass(checkbox, false); // セルの色を変更
    }
  });

  // 書き換えた文字列を設定
  document.getElementById('output').value = output;
}

for (let x = 0; x < 5; x++) {
  const table = document.createElement('table');

  for (let i = 0; i < 7; i++) {
    const row = document.createElement('tr');

    for (let j = 0; j < 7; j++) {
      const cell = document.createElement('td');
      const id = `${x}-${i}-${j}`;

      // 中央のセルならチェックボックス無しにする
      if (j === 3 && i === 3) {
        cell.classList.add('center');
      } else {
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = id;
        cell.appendChild(checkbox);

        // チェックボックスの直接のクリック操作を無効にする
        checkbox.addEventListener('click', (event) => {
          event.stopPropagation();
        });
        
        // セルのクリックでチェックボックスを切り替える
        cell.addEventListener('click', () => {
  if (isSyncEnabled) {
    checkbox.checked = !checkbox.checked;
    checkbox.dispatchEvent(new Event('change'));
  } else {
    // 同期がオフの場合はチェックボックスを直接切り替える
    checkbox.checked = !checkbox.checked;
    updateOutput();
  }
});
      }

      row.appendChild(cell);
    }

    // ヘッダ行を作成（右端まで結合）
    if (i === 0) {
      const headerRow = document.createElement('tr');
      const headerCell = document.createElement('th');
      headerCell.colSpan = 7; // 右端まで結合
      headerCell.textContent = `Lv.${x + 1}`;
      headerRow.appendChild(headerCell);
      table.appendChild(headerRow);
    }

    table.appendChild(row);
  }

  tables.appendChild(table);
}

document.getElementById('main').appendChild(tables);

// チェックボックスにchangeイベントリスナーを設定
const checkboxes = document.querySelectorAll('input[type="checkbox"]');
checkboxes.forEach(checkbox => {
  checkbox.addEventListener('change', () => {
    updateOutput();
    const [tableIndex, rowIndex, columnIndex] = checkbox.id.split('-').map(Number);

    if (isSyncEnabled) {
      for (let i = tableIndex + 1; i < 5; i++) {
        const otherTableCheckbox = document.getElementById(`${i}-${rowIndex}-${columnIndex}`);
        if (otherTableCheckbox) {
          otherTableCheckbox.checked = checkbox.checked;
          otherTableCheckbox.dispatchEvent(new Event('change'));
          toggleCellClass(otherTableCheckbox, checkbox.checked);
        }
      }
    }
  });
});


// 同期機能をオン/オフするチェックボックスを追加
const syncDiv = document.createElement('div');
syncDiv.classList.add('toggleSync');

const syncCheckbox = document.createElement('input');
syncCheckbox.type = 'checkbox';
syncCheckbox.id = 'sync-checkbox';
syncCheckbox.checked = true; // デフォルトで同期を有効にする

// 同期機能のチェックボックスのラベルを追加
const syncLabel = document.createElement('label');
syncLabel.textContent = '上位レベルに同期';
syncLabel.setAttribute('for', 'sync-checkbox');

syncDiv.appendChild(syncCheckbox);
syncDiv.appendChild(syncLabel);

document.getElementById('main').appendChild(syncDiv);


// 同期チェックボックスのchangeイベントをリスン
syncCheckbox.addEventListener('change', () => {
  isSyncEnabled = syncCheckbox.checked;

  // すべてのチェックボックスを同期/非同期に設定
  checkboxes.forEach(checkbox => {
    checkbox.disabled = !isSyncEnabled;
  });
});

// 同期機能の初期設定
isSyncEnabled = syncCheckbox.checked;
checkboxes.forEach(checkbox => {
  checkbox.disabled = !isSyncEnabled;
});

// コピーボタンをクリックしたときにテキストをクリップボードにコピー
document.getElementById('copy').addEventListener('click', () => {
  const outputTextarea = document.getElementById('output');
  outputTextarea.select(); // テキストエリアのテキストを選択
  document.execCommand('copy'); // テキストをクリップボードにコピー

  const messageDiv = document.getElementById('message');
  messageDiv.textContent = ' テキストがクリップボードにコピーされました';
});

  </script>
</body>
</html>